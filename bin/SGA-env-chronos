#!/bin/bash
# Set up SGA code

echo 'Loading SGA project'

unset PYTHONPATH # Clear PYTHONPATH

project=SGA2025

export SGA_CODE_DIR=${IM_CODE_DIR}/SGA
export LEGACYHALOS_CODE_DIR=$IM_CODE_DIR/legacyhalos
export LEGACYPIPE_CODE_DIR=${IM_CODE_DIR}/legacysurvey/legacypipe
export PYTHONPATH=$SGA_CODE_DIR/py:$LEGACYHALOS_CODE_DIR/py:$LEGACYPIPE_CODE_DIR/py:$PYTHONPATH
export PATH=$SGA_CODE_DIR/bin/$project:$PATH

export DESI_PRODUCT_ROOT=$IM_CODE_DIR/desihub
for package in desiutil desimodel; do
    export PATH=$DESI_PRODUCT_ROOT/$package/bin:$PATH
    export PYTHONPATH=$DESI_PRODUCT_ROOT/$package/py:$PYTHONPATH
done

export SGA_DIR=$IM_PROJECTS_DIR/SGA/2025
export SGA_DATA_DIR=$IM_PROJECTS_DIR/SGA/2025/data
export SGA_HTML_DIR=$IM_PROJECTS_DIR/SGA/2025/html

export ASTROMETRY_DIR=${IM_CODE_DIR}/astrometry/lib/python

# brew install astrometry-net
#export ASTROMETRY_DIR=/opt/homebrew/Cellar/astrometry-net/0.95_2/libexec/lib/python3.12/site-packages

# pip install --install-option="--prefix=/usr/local" --no-cache -e git+https://github.com/dstndstn/astrometry.net@0.95#egg=astrometry
#export ASTROMETRY_DIR=/usr/local/astrometry

#export ASTROMETRY_DIR=$IM_CODE_DIR/astrometry
#export SPS_HOME=${IM_RESEARCH_DIR}/synthesis/fsps

#export PYTHONPATH=/opt/homebrew/Cellar/astrometry-net/0.91/libexec/lib/python3.11/site-packages/astrometry:$PYTHONPATH

# pip install --no-cache -e git+https://github.com/dstndstn/tractor@dr10.4#egg=tractor
export TRACTOR_DIR=/usr/local/tractor

export PYTHONPATH=${ASTROMETRY_DIR}:${PYTHONPATH}
export PYTHONPATH=${TRACTOR_DIR}:${PYTHONPATH}
#export PYTHONPATH=${ASTROMETRY_DIR}/lib/python:${PYTHONPATH}
#export PYTHONPATH=${IM_CODE_DIR}/tractor:$PYTHONPATH
#export PYTHONPATH=${LEGACYHALOS_CODE_DIR}/py:$PYTHONPATH

#export PATH=${IM_CODE_DIR}/SGA/bin:$PATH
#export PATH=${IM_CODE_DIR}/SGA/science/SGA2020:$PATH
#export PATH=${IM_CODE_DIR}/legacyhalos/bin:$PATH
#export PATH=$ASTROMETRY_DIR/bin:${PATH}

#export PYTHONPATH=/opt/homebrew/Caskroom/miniforge/base/envs/SGA/lib/python3.11/site-packages:${PYTHONPATH}

#export LEGACY_SURVEY_DIR=$HOME/work/legacysurvey/dr9
export LEGACY_SURVEY_BASEDIR=$HOME/work/legacysurvey

conda activate SGA

echo 'SGA_DIR='$SGA_DIR
echo 'SGA_DATA_DIR='$SGA_DATA_DIR
echo 'SGA_HTML_DIR='$SGA_HTML_DIR
echo 'SGA_CODE_DIR='$SGA_CODE_DIR
